name: CSS Figma Export

on:
  repository_dispatch:
    types: [css-export]

jobs:
  export:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Print received data
        env:
          CLIENT_PAYLOAD: ${{ github.event.client_payload.data }}
        run: |
          node - <<'EOF'
          try {
            const payload = JSON.parse(process.env.CLIENT_PAYLOAD);
            console.log("Parsed payload:", payload);
          } catch (e) {
            console.error("Failed to parse payload:", e);
            console.error("Raw payload:", process.env.CLIENT_PAYLOAD);
            process.exit(1);
          }
          EOF
